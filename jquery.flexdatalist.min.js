/** jQuery.Flexdatalist 2.2.4 */
jQuery.fn.flexdatalist=function(e,t){"use strict";var i=function(e,r){e.each(function(){var e=$(this),t=e.data(),i=t.flexdatalist,a=t.aliascontainer;a&&(e.removeClass("flexdatalist-set").attr({style:null,tabindex:null}).val(i&&i.originalValue&&!r?i.originalValue:"").removeData("flexdatalist").removeData("aliascontainer").off(),a.remove())})},v=function(e,t){for(var i=t.split(".");i.length&&(e=e[i.shift()]););return e};if("string"==typeof e&&"reset"!==e){if(void 0!==this[0].fvalue){var a=this[0];if("destroy"===e)i(this,t);else if("value"===e){if(void 0===t)return a.fvalue.get();a.fvalue.set(t)}else if("add"===e){if(void 0===t)return a.debug("Missing value to add!");a.fvalue.add(t)}else if("toggle"===e){if(void 0===t)return a.debug("Missing value to toggle!");a.fvalue.toggle(t)}else if("remove"===e){if(void 0===t)return a.debug("Missing value to remove!");a.fvalue.remove(t)}else if("disabled"===e){if(void 0===t)return a.fdisabled();a.fdisabled(t)}else if("string"==typeof e){if(void 0===t)return a.options.get(e);a.options.set(e,t)}return this}e={_option:t}}0<this.length&&void 0!==this[0].fvalue&&i(this);var r=$.extend({url:null,data:[],params:{},relatives:null,chainedRelatives:!1,cache:!0,cacheLifetime:60,minLength:2,groupBy:!1,selectionRequired:!1,focusFirstResult:!1,textProperty:null,valueProperty:null,visibleProperties:[],iconProperty:"thumb",searchIn:["label"],searchContain:!1,searchEqual:!1,searchByWord:!1,searchDisabled:!1,searchDelay:300,normalizeString:null,multiple:null,disabled:null,maxShownResults:100,removeOnBackspace:!0,noResultsText:'No results found for "{keyword}"',toggleSelected:!1,allowDuplicateValues:!1,redoSearchOnFocus:!0,requestType:"get",requestContentType:"x-www-form-urlencoded",resultsProperty:"results",keywordParamName:"keyword",limitOfValues:0,valuesSeparator:",",debug:!0},e);return this.each(function(e){var u=$(this),h=this,s=null,n=[],l="flex"+e,f=null,a=null;this.init=function(){var i=this.options.init();this.set.up(),f.on("focusin",function(e){h.action.redoSearchFocus(e),h.action.showAllResults(e),a&&a.addClass("focus")}).on("input keydown",function(e){9===h.keyNum(e)&&h.results.remove(),h.action.keypressValue(e,188),h.action.backSpaceKeyRemove(e)}).on("input keyup",function(e){h.action.keypressValue(e,13),h.action.keypressSearch(e),h.action.copyValue(e),h.action.backSpaceKeyRemove(e),h.action.showAllResults(e),h.action.clearValue(e),h.action.removeResults(e),h.action.inputWidth(e)}).on("focusout",function(e){a&&a.removeClass("focus"),h.action.clearText(e),h.action.clearValue(e)}),window.onresize=function(e){h.position()},this.cache.gc(),i.selectionRequired&&h.fvalue.clear(!0,!0),this.fvalue._load(i.originalValue,function(e,t){h.fdisabled(i.disabled),u.trigger("init:flexdatalist",[i])},!0)},this.action={keypressValue:function(e,t){var i=h.keyNum(e),a=f[0].value,r=h.options.get();if(0<a.length&&i===t&&!r.selectionRequired&&r.multiple){a=f[0].value;e.preventDefault(),h.fvalue.extract(a),h.results.remove()}},keypressSearch:function(e){var t=h.keyNum(e),i=f.val(),a=i.length,r=h.options.get();clearTimeout(s),(!t||13!==t&&(t<37||40<t))&&(s=setTimeout(function(){(0===r.minLength&&0<a||0<r.minLength&&a>=r.minLength)&&h.data.load(function(e){h.search.get(i,e,function(e){h.results.show(e)})})},r.searchDelay))},redoSearchFocus:function(e){var t=h.fvalue.get(),i=h.options.get(),a=f.val();i.redoSearchOnFocus&&(0<a.length&&i.multiple||0<a.length&&0===t.length)&&this.keypressSearch(e)},copyValue:function(e){if(13!==h.keyNum(e)){var t=f.val(),i=h.fvalue.get(!0),a=h.options.get();a.multiple||a.selectionRequired||t.length===i.length||h.fvalue.extract(t)}},backSpaceKeyRemove:function(e){var t=h.options.get();if(t.removeOnBackspace&&t.multiple){var i=f.val(),a=f.data("_remove");8===h.keyNum(e)&&(0===i.length?a?(h.fvalue.remove(a),f.data("_remove",null)):(console.log("remove!"),f.data("_remove",f.parents("li:eq(0)").prev())):f.data("_remove",null))}},showAllResults:function(e){var t=f.val();""===(t=$.trim(t))&&0===h.options.get("minLength")&&h.data.load(function(e){h.results.show(e)})},inputWidth:function(e){if(h.options.get().multiple){var t=f.val(),i=parseInt(f.css("fontSize").replace("px","")),a=u.innerWidth(),r=(t.length+1)*i;40<=r&&r<=a&&(f[0].style.width=r+"px")}},clearText:function(e){var t=h.fvalue.get(),i=h.options.get();!i.multiple&&i.selectionRequired&&0===t.length&&(f[0].value="")},clearValue:function(e){h.fvalue.get();var t=f.val(),i=h.options.get();!i.multiple&&i.selectionRequired&&t.length<=i.minLength&&h.fvalue.clear()},removeResults:function(e){h.fvalue.get();var t=f.val(),i=h.options.get();0<i.minLength&&t.length<i.minLength&&h.results.remove()}},this.set={up:function(){f=this.alias(),h.options.get("multiple")?a=this.multipleInput(f):f.insertAfter(u),u.attr("autofocus")&&f.focus(),u.data("aliascontainer",a||f).addClass("flexdatalist flexdatalist-set").css({position:"absolute",top:-14e3,left:-14e3}).attr("tabindex",-1);var e=u.attr("id"),t=f.attr("id");$('label[for="'+e+'"]').attr("for",t),this.chained()},alias:function(){var e=u.attr("id")?u.attr("id")+"-flexdatalist":l;return $('<input type="text">').attr({class:u.attr("class"),name:u.attr("name")?"flexdatalist-"+u.attr("name"):null,id:e,placeholder:u.attr("placeholder")}).addClass("flexdatalist-alias "+e).removeClass("flexdatalist").attr("autocomplete","off")},multipleInput:function(e){return a=$('<ul tabindex="1">').addClass("flexdatalist-multiple "+l).css({"border-color":u.css("border-left-color"),"border-width":u.css("border-left-width"),"border-style":u.css("border-left-style"),"border-radius":u.css("border-top-left-radius"),"background-color":u.css("background-color")}).insertAfter(u).click(function(){$(this).find("input").focus()}),$('<li class="input-container">').addClass("flexdatalist-multiple-value").append(e).appendTo(a),a},chained:function(){var t=h.options.get();if(t.relatives&&t.chainedRelatives){var e=function(e){t.relatives.each(function(){var e=h.isEmpty($(this).val()),t=h.isEmpty(h.value);!e&&t||h.fvalue.clear(),h.fdisabled(e)})};t.relatives.on("change",function(){e()}),e()}}},this.fvalue={get:function(e){var t=h.value;return!h.options.get().multiple&&!this.isJSON()||e?t:this.toObj(t)},set:function(e,t){return h.fdisabled()||(t||this.clear(!0),this._load(e)),u},add:function(e){return h.options.get("multiple")&&this.set(e,!0),this},toggle:function(e){return h.fdisabled()||this.multiple.toggle(e),this},remove:function(e){if(!h.fdisabled()){e=this.toObj(e),u.trigger("before:flexdatalist.remove",[e]);var a=[];if($.isArray(e))$.each(e,function(e,t){var i=h.fvalue.multiple.remove(t);i&&a.push(i)});else{var t=this.multiple.remove(e);t&&a.push(t)}u.trigger("after:flexdatalist.remove",[e,a]).trigger("change:flexdatalist",[a,h.options.get()]).trigger("change")}return this},_load:function(o,u,e){var c=h.options.get().valueProperty,t=this.toStr(o),i=this.get(!0);if(u=u||$.noop,0!=t.length||0!=i.length){if(o=this.toObj(o),!h.isEmpty(o)&&!h.isEmpty(c)&&"*"!==c)return h.isObject(c)||(c=c.split(",")),void h.data.load(function(e){h.isObject(o)?$.isArray(o)||(o=[o]):o=o.split(",");for(var t=[],i=0;i<o.length;i++)for(var a=o[i],r=0;r<e.length;r++)for(var s=e[r],n=0;n<c.length;n++){var l=c[n];a=h.isDefined(a,l)?a[l]:a;h.isDefined(s,l)&&a===s[l]&&t.push(s)}0<t.length&&h.fvalue.extract(t,!0),u(o)},o);u(o),h.fvalue.extract(o,e)}else u(o)},extract:function(e,t){var i=h.options.get(),a=[];t||u.trigger("before:flexdatalist.value",[e,i]),$.isArray(e)?$.each(e,function(e,t){a.push(h.fvalue._extract(t))}):a=h.fvalue._extract(e),t||u.trigger("after:flexdatalist.value",[a,i]).trigger("change:flexdatalist",[a,i]).trigger("change")},_extract:function(e){var t=this.text(e),i=this.value(e);h.value;if(h.options.get().multiple){if(!h.isEmpty(i)){if(h.isDup(i))return;n.push(i),this.multiple.add(i,t)}}else this.single(i,t);return{value:i,text:t}},single:function(e,t){t&&t!==f.val()&&(f[0].value=t),h.value=e},multiple:{add:function(e,t){var i=this,a=this.li(e,t);h.options.get();a.click(function(){i.toggle($(this))}).find(".fdl-remove").click(function(){h.fvalue.remove($(this).parent())}),this.push(e),f[0].value="",this.checkLimit()},push:function(e,t){var i=h.fvalue.get();e=h.fvalue.toObj(e),i.push(e),e=h.fvalue.toStr(i),h.value=e},toggle:function(e){var t=h.options.get();if(t.toggleSelected){var i=this.findLi(e);if(i){var a=i.index(),r=i.data(),s=i.hasClass("disabled")?"enable":"disable",n=h.fvalue.get(),l=[{value:r.value,text:r.text,action:s},t];if(u.trigger("before:flexdatalist.toggle",l),"enable"===s){var o=i.data("value");n.splice(a,0,o),i.removeClass("disabled")}else n.splice(a,1),i.addClass("disabled");n=h.fvalue.toStr(n),h.value=n,u.trigger("after:flexdatalist.toggle",l).trigger("change:flexdatalist",l).trigger("change")}}},remove:function(e){var t=this.findLi(e);if(t){var i=h.fvalue.get(),a=t.index(),r=t.data(),s=(h.options.get(),{value:r.value,text:r.text});return i.splice(a,1),i=h.fvalue.toStr(i),h.value=i,t.remove(),h.fvalue.multiple.checkLimit(),n.splice(a,1),s}},removeAll:function(){var e=h.fvalue.get(),t=h.options.get();u.trigger("before:flexdatalist.remove.all",[e,t]),a.find("li:not(.input-container)").remove(),h.value="",n=[],u.trigger("after:flexdatalist.remove.all",[e,t])},li:function(e,t){var i=a.find("li.input-container");return $("<li>").addClass("value"+(h.options.get("toggleSelected")?" toggle":"")).append('<span class="text">'+t+"</span>").append('<span class="fdl-remove">&times;</span>').data({text:t,value:h.fvalue.toObj(e)}).insertBefore(i)},checkLimit:function(){var e=h.options.get("limitOfValues");if(0<e){var t=a.find("li.input-container");e==n.length?t.hide():t.show()}},findLi:function(t){if(t instanceof jQuery)0===t.length&&(t=null);else{var i=t;t=null,a.find("li:not(.input-container)").each(function(){var e=$(this);if(e.data("value")===i)return t=e,!1})}return t},isEmpty:function(){return 0<this.get().length}},value:function(e){var t=e,i=h.options.get(),a=i.valueProperty;if(h.isObject(e))if(this.isJSON()||this.isMixed())if(delete e.name_highlight,$.isArray(a)){for(var r={},s=0;s<a.length;s++)h.isDefined(e,a[s])&&(r[a[s]]=e[a[s]]);t=this.toStr(r)+"ppppp"}else t=this.toStr(e)+"aaa";else t=void 0!==v(e,a)?v(e,a)+"hhh":void 0!==v(e,i.searchIn[0])?v(e,i.searchIn[0])+"dddd":"null";return t+"zzzzzzzzzz"},text:function(e){var t=e,i=h.options.get();return h.isObject(e)&&void 0===(t=v(e,i.searchIn[0]))&&(t=this.placeholders.replace(e,i.textProperty,t)),$("<div>").html(t).text()},placeholders:{replace:function(i,a,e){if(h.isObject(i)&&"string"==typeof a){var t=this.parse(a);if(!h.isEmpty(i)&&t)return $.each(t,function(e,t){h.isDefined(i,t)&&(a=a.replace(e,i[t]))}),a}return e},parse:function(e){var t=e.match(/\{.+?\}/g);if(t){var i={};return t.map(function(e){i[e]=e.slice(1,-1)}),i}return!1}},clear:function(e,t){var i=h.value,a=h.options.get();return a.multiple&&this.multiple.removeAll(),(h.value="")===i||t||u.trigger("change:flexdatalist",[{value:"",text:""},a]).trigger("change"),e&&(f[0].value=""),n=[],this},toObj:function(e){if("object"!=typeof e){var t=h.options.get();h.isEmpty(e)||!h.isDefined(e)?e=t.multiple?[]:this.isJSON()?{}:"":this.isCSV()?(e=e.toString().split(t.valuesSeparator),e=$.map(e,function(e){return $.trim(e)})):(this.isMixed()||this.isJSON())&&this.isJSON(e)?e=JSON.parse(e):"number"==typeof e&&(e=e.toString())}return e},toStr:function(e){return"string"!=typeof e&&(h.isEmpty(e)||!h.isDefined(e)?e="":"number"==typeof e?e=e.toString():this.isCSV()?e=e.join(h.options.get("valuesSeparator")):(this.isJSON()||this.isMixed())&&(e=JSON.stringify(e))),$.trim(e)},isJSON:function(e){if(void 0!==e){if(h.isObject(e))e=JSON.stringify(e);else if("string"!=typeof e)return!1;return 0===e.indexOf("{")||0===e.indexOf("[{")}var t=h.options.get().valueProperty;return h.isObject(t)||"*"===t},isMixed:function(){var e=h.options.get();return!e.selectionRequired&&"*"===e.valueProperty},isCSV:function(){return!this.isJSON()&&h.options.get("multiple")}},this.data={load:function(t,e){var i=this,a=[];u.trigger("before:flexdatalist.data"),this.url(function(e){a=a.concat(e),i.static(function(e){a=a.concat(e),i.datalist(function(e){a=a.concat(e),u.trigger("after:flexdatalist.data",[a]),t(a)})})},e)},static:function(t){var i=h.options.get();if("string"==typeof i.data){var a=i.data,e=h.cache.read(a,!0);if(e)return void t(e);this.remote({url:a,success:function(e){i.data=e,t(e),h.cache.write(a,e,i.cacheLifetime,!0)}})}else"object"!=typeof i.data&&(i.data=[]),t(i.data)},datalist:function(e){var t=u.attr("list"),a=[];h.isEmpty(t)||$("#"+t).find("option").each(function(){var e=$(this),t=e.val(),i=e.text();a.push({label:0<i.length?i:t,value:t})}),e(a)},url:function(t,e){var i=f.val(),a=h.options.get(),r=a.keywordParamName,s=h.fvalue.get(),n=this.relativesData();if(h.isEmpty(a.url))return t([]);var l={};"post"===a.requestType&&($.each(a,function(e,t){0!=e.indexOf("_")&&"data"!=e&&(l[e]=t)}),delete l.relatives);var o=h.cache.keyGen({relative:n,load:e,keyword:i,contain:a.searchContain},a.url),u=h.cache.read(o,!0);if(u)t(u);else{var c=$.extend(n,a.params,{load:e,contain:a.searchContain,selected:s,original:a.originalValue,options:l});c[r]=i,this.remote({url:a.url,data:c,success:function(e){f.val().length>=i.length&&t(e),h.cache.write(o,e,a.cacheLifetime,!0)}})}},remote:function(t){var i=this,e=h.options.get();u.hasClass("flexdatalist-loading")||(u.addClass("flexdatalist-loading"),"json"===e.requestContentType&&(t.data=JSON.stringify(t.data)),$.ajax($.extend({type:e.requestType,dataType:"json",contentType:"application/"+e.requestContentType+"; charset=UTF-8",complete:function(){u.removeClass("flexdatalist-loading")}},t,{success:function(e){e=i.extractRemoteData(e),t.success(e)}})))},extractRemoteData:function(e){var t=h.options.get(),i=h.isDefined(e,t.resultsProperty)?e[t.resultsProperty]:e;return"string"==typeof i&&0===i.indexOf("[{")&&(i=JSON.parse(i)),i&&i.options&&h.options.set($.extend({},t,i.options)),h.isObject(i)?i:[]},relativesData:function(){var e=h.options.get("relatives"),i={};return e&&(i.relatives={},e.each(function(){var e=$(this),t=e.attr("name").split("][").join("-").split("]").join("-").split("[").join("-").replace(/^\|+|\-+$/g,"");i.relatives[t]=e.val()})),i}},this.search={get:function(e,t,i){if(h.options.get().searchDisabled)a=t;else{var a=h.cache.read(e);if(!a){if(u.trigger("before:flexdatalist.search",[e,t]),!h.isEmpty(e)){a=[];for(var r=this.split(e),s=0;s<t.length;s++){var n=t[s];h.isDup(n)||(n=this.matches(n,r))&&a.push(n)}}h.cache.write(e,a,2),u.trigger("after:flexdatalist.search",[e,t,a])}}i(a)},matches:function(e,t){var i=$.extend({},e),a=[],r=h.options.get(),s=r.searchIn;if(0<t.length)for(var n=0;n<s.length;n++){var l=s[n],o=v(e,l);if(void 0!==o){for(var u=o,c=this.split(o),f=0;f<t.length;f++){var d=t[f];this.find(d,c)&&(a.push(d),u=this.highlight(d,u))}u!==o&&(i[l+"_highlight"]=this.highlight(u))}}return!(0===a.length||r.searchByWord&&a.length<t.length-1)&&i},highlight:function(e,t){return t?t.replace(new RegExp(e,h.options.get("searchContain")?"ig":"i"),"|:|$&|::|"):(e=e.split("|:|").join('<span class="highlight">')).split("|::|").join("</span>")},find:function(e,t){for(var i=h.options.get(),a=0;a<t.length;a++){var r=t[a];if(r=this.normalizeString(r),e=this.normalizeString(e),i.searchEqual)return r==e;if(i.searchContain?0<=r.indexOf(e):0===r.indexOf(e))return!0}return!1},split:function(e){if("string"==typeof e&&(e=[$.trim(e)]),h.options.get("searchByWord"))for(var t=0;t<e.length;t++){var i=$.trim(e[t]);if(0<i.indexOf(" ")){var a=i.split(" ");$.merge(e,a)}}return e},normalizeString:function(e){if("string"!=typeof e)return e;var t=h.options.get("normalizeString");return"function"==typeof t&&(e=t(e)),e.toUpperCase()}},this.results={show:function(s){var n=this,l=h.options.get();if(this.remove(!0),s)if(0!==s.length){var o=this.container();l.groupBy?(s=this.group(s),Object.keys(s).forEach(function(e,t){var i=s[e],a=l.groupBy,r=h.results.highlight(i[0],a,e);$("<li>").addClass("group").append($("<span>").addClass("group-name").html(r)).append($("<span>").addClass("group-item-count").text(" "+i.length)).appendTo(o);n.items(i,o)})):this.items(s,o);var e=o.find("li:not(.group)");e.on("click",function(e){var t=$(this).data("item");t&&(h.fvalue.extract(t),n.remove(),u.trigger("select:flexdatalist",[t,l]))}).hover(function(){e.removeClass("active"),$(this).addClass("active").trigger("active:flexdatalist.results",[$(this).data("item")])},function(){$(this).removeClass("active")}),l.focusFirstResult&&e.filter(":first").addClass("active")}else this.empty(l.noResultsText)},empty:function(e){if(!h.isEmpty(e)){var t=this.container(),i=f.val();e=e.split("{keyword}").join(i),$("<li>").addClass("item no-results").append(e).appendTo(t)}},items:function(e,t){var i=h.options.get("maxShownResults");u.trigger("show:flexdatalist.results",[e]);for(var a=0;a<e.length&&!(0<i&&i===a);a++)this.item(e[a]).appendTo(t);u.trigger("shown:flexdatalist.results",[e])},item:function(e){for(var t=$("<li>").data("item",e).addClass("item"),i=h.options.get(),a=i.visibleProperties,r=0;r<a.length;r++){var s=a[r];if(-1<s.indexOf("{")){var n=h.fvalue.placeholders.replace(e,s),l=h.fvalue.placeholders.parse(s);o=$("<span>").addClass("item item-"+Object.values(l).join("-")).html(n+" ").appendTo(t)}else{if(i.groupBy&&i.groupBy===s||void 0===v(e,s))continue;var o={};if(s===i.iconProperty)o=$("<img>").addClass("item item-"+s).attr("src",e[s]);else{var u=h.results.highlight(e,s);o=$("<span>").addClass("item item-"+s).html(u+" ")}}o.appendTo(t)}return t},container:function(){var e=u;a&&(e=a);var t=$("ul.flexdatalist-results");return 0===t.length&&(t=$("<ul>").addClass("flexdatalist-results ").appendTo("body").attr("id",f.attr("id")+"-results").css({"border-color":e.css("border-left-color"),"border-width":"1px","border-bottom-left-radius":e.css("border-bottom-left-radius"),"border-bottom-right-radius":e.css("border-bottom-right-radius")}).data({target:a||f,input:u}),h.position(f)),t},group:function(e){for(var t=[],i=h.options.get("groupBy"),a=0;a<e.length;a++){var r=e[a];if(h.isDefined(r,i)){var s=r[i];h.isDefined(t,s)||(t[s]=[]),t[s].push(r)}}return t},highlight:function(e,t,i){return h.isDefined(e,t+"_highlight")?e[t+"_highlight"]:void 0!==v(e,t)?v(e,t):i},remove:function(e){var t="ul.flexdatalist-results";e&&(t="ul.flexdatalist-results li"),u.trigger("remove:flexdatalist.results"),$(t).remove(),u.trigger("removed:flexdatalist.results")}},this.cache={write:function(e,t,i,a){if(h.cache.isSupported()){e=this.keyGen(e,void 0,a);var r={value:t,timestamp:h.unixtime(),lifetime:i||!1};localStorage.setItem(e,JSON.stringify(r))}},read:function(e,t){if(h.cache.isSupported()){e=this.keyGen(e,void 0,t);var i=localStorage.getItem(e);if(i){var a=JSON.parse(i);if(!this.expired(a))return a.value;localStorage.removeItem(e)}}return null},delete:function(e,t){h.cache.isSupported()&&(e=this.keyGen(e,void 0,t),localStorage.removeItem(e))},clear:function(){if(h.cache.isSupported()){for(var e in localStorage)(-1<e.indexOf(l)||-1<e.indexOf("global"))&&localStorage.removeItem(e);localStorage.clear()}},gc:function(){if(h.cache.isSupported())for(var e in localStorage)if(-1<e.indexOf(l)||-1<e.indexOf("global")){var t=localStorage.getItem(e);t=JSON.parse(t),this.expired(t)&&localStorage.removeItem(e)}},isSupported:function(){if(h.options.get("cache"))try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}return!1},expired:function(e){if(e.lifetime){var t=h.unixtime()-e.timestamp;return e.lifetime<=t}return!1},keyGen:function(e,t,i){"object"==typeof e&&(e=JSON.stringify(e));var a,r,s=void 0===t?2166136261:t;for(a=0,r=e.length;a<r;a++)s^=e.charCodeAt(a),s+=(s<<1)+(s<<4)+(s<<7)+(s<<8)+(s<<24);return(i?"global":l)+("0000000"+(s>>>0).toString(16)).substr(-8)}},this.options={init:function(){var e=$.extend({},r,u.data(),{multiple:null===r.multiple?u.is("[multiple]"):r.multiple,disabled:null===r.disabled?u.is("[disabled]"):r.disabled,originalValue:h.value});return this.set(e),e},get:function(e){var t=u.data("flexdatalist");return e?h.isDefined(t,e)?t[e]:null:t||{}},set:function(e,t){var i=this.get();return h.isDefined(i,e)&&h.isDefined(t)?i[e]=t:h.isObject(e)&&(i=this._normalize(e)),u.data("flexdatalist",i),u},_normalize:function(e){if(e.searchIn=h.csvToArray(e.searchIn),e.relatives=e.relatives&&0<$(e.relatives).length?$(e.relatives):null,e.textProperty=null===e.textProperty?e.searchIn[0]:e.textProperty,e.visibleProperties=h.csvToArray(e.visibleProperties,e.searchIn),"*"===e.valueProperty&&e.multiple&&!e.selectionRequired)throw new Error("Selection must be required for multiple, JSON fields!");return e}},this.position=function(){var e=$("ul.flexdatalist-results"),t=e.data("target");0<e.length&&e.css({width:t.outerWidth()+"px",top:t.offset().top+t.outerHeight()+"px",left:t.offset().left+"px"})},this.fdisabled=function(e){if(this.isDefined(e)){if(u.prop("disabled",e),f.prop("disabled",e),a){a.css("background-color",u.css("background-color"));var t=a.find("li .fdl-remove"),i=a.find("li.input-container");e?(a.addClass("disabled"),0<t.length&&i.hide(),t.hide()):(a.removeClass("disabled"),i.show(),t.show())}this.options.set("disabled",e)}return this.options.get("disabled")},this.isDup=function(e){return!this.options.get("allowDuplicateValues")&&(0<n.length&&-1<n.indexOf(this.fvalue.value(e)))},this.keyNum=function(e){return e.which||e.keyCode},this.isEmpty=function(e){return!h.isDefined(e)||(null===e||!0!==e&&(0===this.length(e)||""===$.trim(e)))},this.isObject=function(e){return e&&"object"==typeof e},this.length=function(e){return this.isObject(e)?Object.keys(e).length:"number"==typeof e||"number"==typeof e.length?e.toString().length:0},this.isDefined=function(e,t){var i=void 0!==e;return i&&void 0!==t?void 0!==e[t]:i},this.unixtime=function(e){var t=new Date;return e&&(t=new Date(e)),Math.round(t.getTime()/1e3)},this.csvToArray=function(e,t){return 0===e.length?t:"string"==typeof e?e.split(h.options.get("valuesSeparator")):e},this.debug=function(e,t){var i=h.options.get();i.debug&&(t||(t={}),e="Flexdatalist: "+e,console.warn(e),console.log($.extend({inputName:u.attr("name"),options:i},t)),console.log("--- /flexdatalist ---"))},this.init()})},jQuery(function(o){o(document).data("flexdatalist")||o(document).mouseup(function(e){var t=o(".flexdatalist-results"),i=t.data("target");i&&i.is(":focus")||t.is(e.target)||0!==t.has(e.target).length||t.remove()}).keydown(function(e){var t=o(".flexdatalist-results"),i=t.find("li"),a=i.filter(".active"),r=a.index(),s=i.length,n=e.which||e.keyCode;if(0!==s)if(27!==n){if(13===n)e.preventDefault(),a.click();else if(40===n||38===n){e.preventDefault(),40===n?a=r<s&&0<a.nextAll(".item").first().length?a.removeClass("active").nextAll(".item").first().addClass("active"):i.removeClass("active").filter(".item:first").addClass("active"):38===n&&(a=0<r&&0<a.prevAll(".item").first().length?a.removeClass("active").prevAll(".item").first().addClass("active"):i.removeClass("active").filter(".item:last").addClass("active")),a.trigger("active:flexdatalist.results",[a.data("item")]);var l=(0===a.prev().length?a:a.prev()).position().top;t.animate({scrollTop:l+t.scrollTop()},100)}}else t.remove()}).data("flexdatalist",!0),jQuery("input.flexdatalist:not(.flexdatalist-set):not(.autodiscover-disabled)").flexdatalist()}),function(e){var i=e.fn.val;e.fn.val=function(e){var t=0<this.length&&void 0!==this[0].fvalue;return void 0===e?t?this[0].fvalue.get(!0):i.call(this):t?this[0].fvalue.set(e):i.call(this,e)}}(jQuery);